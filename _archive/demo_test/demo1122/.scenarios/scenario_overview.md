# 业务场景分析报告 v1.1（全覆盖基线）

## [F001] 导航栏访问
### ✅ 正常流程 (Happy Path)
- 顶部固定展示；未登录显示登录/注册；已登录显示用户名头像；主要入口显示；跳转登录/注册；用户名下拉；当前页面高亮。
### ❌ 异常流程 (Sad Path)
- 登录态过期自动跳转登录页并提示。
### ⚠️ 边界条件 (Edge Case)
- 刷新后导航状态与高亮保持一致。

## [F002] 快捷入口访问
### ✅ 正常流程 (Happy Path)
- 常用功能卡片；个性化推荐（登录）；历史记录最多5条；点击卡片跳转；历史记录一键填充；清除历史需确认。
### ❌ 异常流程 (Sad Path)
- 未登录仅显示基础功能；推荐加载失败降级默认入口。
### ⚠️ 边界条件 (Edge Case)
- 历史记录为空显示占位。

## [F003] 车票查询
### ✅ 正常流程 (Happy Path)
- 完整查询返回车次与余票；中文/拼音模糊搜索；快捷日期；加载状态反馈。
### ❌ 异常流程 (Sad Path)
- 出发地=目的地；超过30天；过去日期；无效类型/时间段；仅有票导致无结果；必填项不完整。
### ⚠️ 边界条件 (Edge Case)
- 接口超时提示重试；重复点击查询触发防抖。

## [F004] 车次筛选
### ✅ 正常流程 (Happy Path)
- 应用筛选实时更新并显示结果数量。
### ❌ 异常流程 (Sad Path)
- 非法类型/席别/站点/时间段/历时范围/价格区间；结果为空提示放宽条件。
### ⚠️ 边界条件 (Edge Case)
- 并发筛选合并处理。

## [F005] 车票预订
### ✅ 正常流程 (Happy Path)
- 选择席别与乘车人生成订单明细；锁票成功跳转订单页。
### ❌ 异常流程 (Sad Path)
- 未登录拦截并跳转；余票不足；乘车人不完整；未同意协议。
### ⚠️ 边界条件 (Edge Case)
- 余票不足提供替代建议。

## [F006] 中转换乘查询
### ✅ 正常流程 (Happy Path)
- 直达无结果自动推荐中转；主动选择方案；显示节省；查询中转站；换乘时间校验；最多5个方案；按历时/总价排序。
### ⚠️ 边界条件 (Edge Case)
- 换乘时间不足警告。

## [F007] 用户登录
### ✅ 正常流程 (Happy Path)
- 账号密码登录生成会话；记住密码（本地加密）；手机验证码登录与倒计时。
### ❌ 异常流程 (Sad Path)
- 手机号格式错误；验证码错误/过期；连续失败触发图形验证码。
### ⚠️ 边界条件 (Edge Case)
- 登录接口超时提示重试。

## [F008] 用户注册
### ✅ 正常流程 (Happy Path)
- 完整注册成功并自动登录；验证码发送含倒计时；密码强度反馈。
### ❌ 异常流程 (Sad Path)
- 手机号格式/已注册；密码长度不足/复杂度不足；两次密码不一致；验证码错误/过期。
### ⚠️ 边界条件 (Edge Case)
- 注册接口超时显示网络繁忙并恢复按钮状态。

## [F009] 订单填写
### ✅ 正常流程 (Happy Path)
- 显示车次信息只读；席别与数量；票价明细；倒计时与不足5分钟警告；已选乘车人；票种选择。
### ❌ 异常流程 (Sad Path)
- 超时释放座位并提示；联系人手机号格式错误。
### ⚠️ 边界条件 (Edge Case)
- 刷新页面恢复临时草稿。

## [F010] 提交订单
### ✅ 正常流程 (Happy Path)
- 前置校验；总价计算含保险；生成订单号锁座设置支付超时。
### ❌ 异常流程 (Sad Path)
- 必填不完整；证件号错误；订单超时；余票不足。
### ⚠️ 边界条件 (Edge Case)
- 重复提交防抖。

## [F011] 个人信息管理
### ✅ 正常流程 (Happy Path)
- 用户名只读；真实姓名；身份证/手机号/邮箱脱敏；注册与最后登录时间；账户等级积分；实名认证状态；修改密码旧密输入与新密强度验证。

## [F012] 乘客管理
### ✅ 正常流程 (Happy Path)
- 列表展示；卡片信息；手机号可选；旅客类型；默认/编辑/删除；默认标识；添加乘车人；实时验证反馈。
### ❌ 异常流程 (Sad Path)
- 身份证校验位错误；护照格式错误。
### ⚠️ 边界条件 (Edge Case)
- 超长姓名/非法字符拦截。

## [F013] 订单管理
### ✅ 正常流程 (Happy Path)
- 状态筛选倒序分页；搜索与详情；卡片字段完整；操作按钮按状态显示。
### ❌ 异常流程 (Sad Path)
- 自定义时间范围非法拦截；取消订单需确认；立即支付跳转支付。

## [F014] 订单支付
### ✅ 正常流程 (Happy Path)
- PC扫码与移动端APP内；银行卡快捷/网银；订单号与金额/优惠；倒计时与轮询；创建支付订单与调起接口；支付成功更新订单并展示成功页。
### ❌ 异常流程 (Sad Path)
- 支付失败显示原因；倒计时到期提示超时。

## [F015] 车票改签
### ✅ 正常流程 (Happy Path)
- 资格校验（状态/类型/次数/时间）；规则说明；同线路默认；日期范围；车次与余票；差价计算；协议确认与提交；成功显示新订单并标记原订单。
### ⚠️ 边界条件 (Edge Case)
- 新车次余票不足提示。

## [F016] 用户登出
### ✅ 正常流程 (Happy Path)
- 导航栏退出清理并返回首页；个人中心安全退出；登出确认；清除session与缓存。
### ❌ 异常流程 (Sad Path)
- 记录失效token失败仍容错完成本地登出。
### ⚠️ 边界条件 (Edge Case)
- 网络异常本地强制登出。